<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started &mdash; MC3 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="MC3 1.0 documentation" href="index.html" />
    <link rel="next" title="Tutorial" href="tutorial.html" />
    <link rel="prev" title="Multi-Core Markov-Chain Monte Carlo (MC3)" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Multi-Core Markov-Chain Monte Carlo (MC3)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MC3 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<span id="getstarted"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="system-requirements">
<h2>System Requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">MC3</span></code> (version 1.1) is known to work (at least) on Unix/Linux (Ubuntu)
and OSX (10.9+) machines, with the following software:</p>
<ul class="simple">
<li>Python (version 2.7)</li>
<li>Numpy (version 1.8.2+)</li>
<li>Scipy (version 0.13.3+)</li>
<li>Matplotlib (version 1.3.1+)</li>
<li>mpi4py (version 1.3.1+)</li>
<li>Message Passing Interface, MPI (MPICH preferred)</li>
</ul>
<p><code class="docutils literal"><span class="pre">MC3</span></code> may work with previous versions of these software.
However we do not guarantee nor provide support for that.</p>
</div>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p>To obtain the latest MCcubed code, clone the repository to your local machine with the following terminal commands. First, create a top-level directory to place the code:</p>
<div class="highlight-shell"><div class="highlight"><pre>mkdir MC3_demo/
<span class="nb">cd </span>MC3_demo/
<span class="nv">topdir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</pre></div>
</div>
<p>Clone the repository to your working directory:</p>
<div class="highlight-shell"><div class="highlight"><pre>git clone https://github.com/pcubillos/MCcubed
</pre></div>
</div>
</div>
<div class="section" id="compile">
<h2>Compile<a class="headerlink" href="#compile" title="Permalink to this headline">¶</a></h2>
<p>Compile the C code:</p>
<div class="highlight-shell"><div class="highlight"><pre><span class="nb">cd</span> <span class="nv">$topdir</span>/MCcubed/src/cfuncs
make
</pre></div>
</div>
<p>To remove the program binaries, execute (from the respective directories):</p>
<div class="highlight-shell"><div class="highlight"><pre>make clean
</pre></div>
</div>
</div>
<div class="section" id="example-1-interactive">
<h2>Example 1 (Interactive)<a class="headerlink" href="#example-1-interactive" title="Permalink to this headline">¶</a></h2>
<p>The following example (<a class="reference external" href="https://github.com/pcubillos/MCcubed/blob/master/examples/demo01/demo01.py">demo01</a>) shows a basic <code class="docutils literal"><span class="pre">MC3</span></code> MCMC run from the Python interpreter.
This example fits a quadratic polynomial curve to a dataset.
First create a folder to run the example (alternatively, run the example from any location, but adjust the paths of the Python script):</p>
<div class="highlight-shell"><div class="highlight"><pre><span class="nb">cd</span> <span class="nv">$topdir</span>
mkdir run01
<span class="nb">cd </span>run01
</pre></div>
</div>
<p>Now start a Python interactive session.  This script imports the necesary modules, creates a noisy dataset, and runs the MCMC:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;../MCcubed/src/&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">mccubed</span> <span class="kn">as</span> <span class="nn">mc3</span>

<span class="c"># Get function to model (and sample):</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;../MCcubed/examples/models/&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">quadratic</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="c"># Create a synthetic dataset:</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>          <span class="c"># Independent model variable</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.5</span>                    <span class="c"># True-underlying model parameters</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>                      <span class="c"># Noiseless model</span>
<span class="n">uncert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>          <span class="c"># Data points uncertainty</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">uncert</span><span class="p">)</span>  <span class="c"># Noise for the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">error</span>                     <span class="c"># Noisy data set</span>

<span class="c"># Fit the quad polynomial coefficients:</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>  <span class="c"># Initial guess of fitting params.</span>

<span class="c"># Run the MCMC:</span>
<span class="n">allp</span><span class="p">,</span> <span class="n">bp</span> <span class="o">=</span> <span class="n">mc3</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">uncert</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">quad</span><span class="p">,</span> <span class="n">indparams</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
                    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">numit</span><span class="o">=</span><span class="mf">3e4</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="outputs">
<h3>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h3>
<p>That&#8217;s it, now let&#8217;s see the results.  <code class="docutils literal"><span class="pre">MC3</span></code> will print out to screen a
progress report every 10% of the MCMC run, showing the time, number of
times a parameter tried to go beyond the boundaries, the current
best-fitting values, and corresponding <span class="math">\(\chi^{2}\)</span>, like this:</p>
<div class="highlight-none"><div class="highlight"><pre>::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  Multi-Core Markov-Chain Monte Carlo (MC3).
  Version 1.1.20.
  Copyright (c) 2015-2016 Patricio Cubillos and collaborators.
  MC3 is open-source software under the MIT license (see LICENSE).
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

Start MCMC chains  (Tue Jan  5 13:11:22 2016)

...

[::        ]  20.0% completed  (Tue Jan  5 13:11:22 2016)
Out-of-bound Trials:
 [0 0 0]
Best Parameters:   (chisq=87.5664)
[ 2.81119952 -2.33026943  0.48622898]

...
</pre></div>
</div>
<p>At the end of the MCMC run, <code class="docutils literal"><span class="pre">MC3</span></code> will display a summary of the MCMC sample, best-fitting parameters, uncertainties, mean values, and statistics:</p>
<div class="highlight-none"><div class="highlight"><pre>Fin, MCMC Summary:
------------------
 Burned in iterations per chain:   100
 Number of iterations per chain:  3000
 MCMC sample size:               29000
 Acceptance rate:   39.39%

 Best-fit params    Uncertainties   Signal/Noise       Sample Mean
   2.8111995e+00    3.8625328e-01           7.28     2.8167688e+00
  -2.3302694e+00    2.2233506e-01          10.48    -2.3308174e+00
   4.8622898e-01    2.7225910e-02          17.86     4.8622772e-01

 Best-parameter&#39;s chi-squared:      87.5664
 Bayesian Information Criterion:   101.3819
 Reduced chi-squared:                0.9027
 Standard deviation of residuals:  2.5201
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">More information will be displayed, depending on the MCMC configuration (see the <a class="reference internal" href="tutorial.html#tutorial"><span>Tutorial</span></a>).</p>
</div>
<p>The user has the option to generate the best-fitting, trace, and posterior MCMC plots (these plots can also be generated automatically with the MCMC run):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">y0</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>  <span class="c"># Initial guess values</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span>     <span class="n">x</span><span class="p">)</span>  <span class="c"># MCMC best fitting values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;-k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;true&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">uncert</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&quot;.b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="s">&quot;-g&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Initial guess&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s">&quot;-r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;MCMC best fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;X&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;quad(x)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/quad_fit.png"><img alt="_images/quad_fit.png" src="_images/quad_fit.png" style="width: 50%;" /></a>
<p>The mcplots module of <code class="docutils literal"><span class="pre">MC3</span></code> provides the functions to plot the parameter
trace and posteriors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Import the mcplots module:</span>
<span class="kn">import</span> <span class="nn">mcplots</span> <span class="kn">as</span> <span class="nn">mp</span>
<span class="c"># Plot trace plot:</span>
<span class="n">parname</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;constant&quot;</span><span class="p">,</span> <span class="s">&quot;linear&quot;</span><span class="p">,</span> <span class="s">&quot;quadratic&quot;</span><span class="p">]</span>
<span class="n">mp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">allp</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Fitting-parameter Trace Plots&quot;</span><span class="p">,</span> <span class="n">parname</span><span class="o">=</span><span class="n">parname</span><span class="p">,</span>
         <span class="n">savefile</span><span class="o">=</span><span class="s">&quot;quad_trace.png&quot;</span><span class="p">)</span>

<span class="c"># Plot pairwise posteriors:</span>
<span class="n">mp</span><span class="o">.</span><span class="n">pairwise</span><span class="p">(</span><span class="n">allp</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Pairwise posteriors&quot;</span><span class="p">,</span> <span class="n">parname</span><span class="o">=</span><span class="n">parname</span><span class="p">,</span>
         <span class="n">savefile</span><span class="o">=</span><span class="s">&quot;quad_pairwise.png&quot;</span><span class="p">)</span>

<span class="c"># Plot marginal posterior histograms:</span>
<span class="n">mp</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">allp</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Marginal posterior histograms&quot;</span><span class="p">,</span> <span class="n">parname</span><span class="o">=</span><span class="n">parname</span><span class="p">,</span>
         <span class="n">savefile</span><span class="o">=</span><span class="s">&quot;quad_hist.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/quad_hist.png"><img alt="_images/quad_hist.png" src="_images/quad_hist.png" style="width: 50%;" /></a>
<a class="reference internal image-reference" href="_images/quad_pairwise.png"><img alt="_images/quad_pairwise.png" src="_images/quad_pairwise.png" style="width: 50%;" /></a>
<a class="reference internal image-reference" href="_images/quad_trace.png"><img alt="_images/quad_trace.png" src="_images/quad_trace.png" style="width: 50%;" /></a>
</div>
</div>
<div class="section" id="example-2-shell-run">
<h2>Example 2 (Shell Run)<a class="headerlink" href="#example-2-shell-run" title="Permalink to this headline">¶</a></h2>
<p>The following example (<a class="reference external" href="https://github.com/pcubillos/MCcubed/blob/master/examples/demo02/">demo02</a>) shows a basic <code class="docutils literal"><span class="pre">MC3</span></code> MCMC run from the Shell prompt.
To start, create a working directory to place the files and execute the program:</p>
<div class="highlight-shell"><div class="highlight"><pre><span class="nb">cd</span> <span class="nv">$topdir</span>
mkdir run02
<span class="nb">cd </span>run02
</pre></div>
</div>
<p>Copy the demo files to run <code class="docutils literal"><span class="pre">MC3</span></code> (configuration and data files):</p>
<div class="highlight-shell"><div class="highlight"><pre>cp <span class="nv">$topdir</span>/MCcubed/examples/demo02/* .
</pre></div>
</div>
<p>Call the <code class="docutils literal"><span class="pre">MC3</span></code> executable, providing the configuration file as command-line argument:</p>
<div class="highlight-shell"><div class="highlight"><pre>mpirun <span class="nv">$topdir</span>/MCcubed/src/mccubed.py -c MCMC.cfg
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compile">Compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-1-interactive">Example 1 (Interactive)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-2-shell-run">Example 2 (Shell Run)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Multi-Core Markov-Chain Monte Carlo (MC3)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="next chapter">Tutorial</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Multi-Core Markov-Chain Monte Carlo (MC3)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MC3 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015-2016, Patricio Cubillos.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>