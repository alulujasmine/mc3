<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MCMC Tutorial &mdash; MC3 2.2.14 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2.14',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="MC3 2.2.14 documentation" href="index.html" />
    <link rel="next" title="Optimization Tutorial" href="fittutorial.html" />
    <link rel="prev" title="Getting Started" href="getstarted.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="fittutorial.html" title="Optimization Tutorial"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="getstarted.html" title="Getting Started"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MC3 2.2.14 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mcmc-tutorial">
<span id="mctutorial"></span><h1>MCMC Tutorial<a class="headerlink" href="#mcmc-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial describes the available options when running an MCMC with <code class="docutils literal"><span class="pre">MC3</span></code>.
As said before, the MCMC can be run from the shell prompt or through a function call in the Python interpreter.</p>
<div class="section" id="argument-inputs">
<h2>Argument Inputs<a class="headerlink" href="#argument-inputs" title="Permalink to this headline">¶</a></h2>
<p>When running from the shell, the arguments can be input as command-line
arguments.  To see all the available options, run:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>./mc3.py --help
</pre></div>
</div>
<p>When running from a Python interactive session, the arguments can be input
as function arguments.  To see the available options, run:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MCcubed</span> <span class="kn">as</span> <span class="nn">mc3</span>
<span class="n">help</span><span class="p">(</span><span class="n">mc3</span><span class="o">.</span><span class="n">mcmc</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally (and strongly recommended),
whether you are running the MCMC from the shell or from
the interpreter, the arguments can be input through a configuration file.</p>
</div>
<div class="section" id="configuration-files">
<h2>Configuration Files<a class="headerlink" href="#configuration-files" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">MC3</span></code> configuration file follows the <a class="reference external" href="https://docs.python.org/2/library/configparser.html">ConfigParser</a> format.
The following code block shows an example for an MC3 configuration file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Comment lines (like this one) are allowed and ignored</span>
<span class="c1"># Strings don&#39;t need quotation marks</span>
<span class="p">[</span><span class="n">MCMC</span><span class="p">]</span>
<span class="c1"># DEMC general options:</span>
<span class="n">nsamples</span>  <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">burnin</span>    <span class="o">=</span> <span class="mi">1000</span>
<span class="n">nchains</span>   <span class="o">=</span> <span class="mi">7</span>
<span class="n">walk</span>      <span class="o">=</span> <span class="n">snooker</span>
<span class="c1"># Fitting function:</span>
<span class="n">func</span>      <span class="o">=</span> <span class="n">quad</span> <span class="n">quadratic</span> <span class="o">../</span><span class="n">MCcubed</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">models</span>
<span class="c1"># Model inputs:</span>
<span class="n">params</span>    <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">dat</span>
<span class="n">indparams</span> <span class="o">=</span> <span class="n">indp</span><span class="o">.</span><span class="n">npz</span>
<span class="c1"># The data and uncertainties:</span>
<span class="n">data</span>      <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">npz</span>
</pre></div>
</div>
</div>
<div class="section" id="mcmc-run">
<h2>MCMC Run<a class="headerlink" href="#mcmc-run" title="Permalink to this headline">¶</a></h2>
<p>This example describes the basic MCMC argument configuration.
The following sub-sections make up a script meant to be run from the Python
interpreter.  The complete example script is located at <a class="reference external" href="https://github.com/pcubillos/MCcubed/blob/master/examples/tutorial01/tutorial01.py">tutorial01</a>.</p>
<div class="section" id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">data</span></code> argument (required) defines the dataset to be fitted.
This argument can be either a 1D float ndarray or the filename (a string)
where the data array is located.</p>
<p>The <code class="docutils literal"><span class="pre">uncert</span></code> argument (required) defines the <span class="math">\(1\sigma\)</span> uncertainties
of the <code class="docutils literal"><span class="pre">data</span></code> array.
This argument can be either a 1D float ndarray (same length of <code class="docutils literal"><span class="pre">data</span></code>) or the filename where the data uncertainties are located.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Create a synthetic dataset using a quadratic polynomial curve:</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../MCcubed/examples/models/&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">quadratic</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>         <span class="c1"># Independent model variable</span>
<span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>                   <span class="c1"># True-underlying model parameters</span>
<span class="n">y</span>  <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>                      <span class="c1"># Noiseless model</span>
<span class="n">uncert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>           <span class="c1"># Data points uncertainty</span>
<span class="n">error</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">uncert</span><span class="p">)</span>  <span class="c1"># Noise for the data</span>
<span class="n">data</span>   <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">error</span>                    <span class="c1"># Noisy data set</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See the <a class="reference internal" href="#datafile"><span>Data</span></a> Section below to find out how to set <code class="docutils literal"><span class="pre">data</span></code> and <code class="docutils literal"><span class="pre">uncert</span></code> as a filename.</p>
</div>
</div>
<div class="section" id="modeling-function">
<h3>Modeling Function<a class="headerlink" href="#modeling-function" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">func</span></code> argument (required) defines the parameterized modeling function.
The user can set <code class="docutils literal"><span class="pre">func</span></code> either as a callable, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Define the modeling function as a callable:</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../MCcubed/examples/models/&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">quadratic</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="n">func</span> <span class="o">=</span> <span class="n">quad</span>
</pre></div>
</div>
<p>or as a tuple of strings pointing to the modeling function, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># A three-elements tuple indicates the function name, the module</span>
<span class="c1"># name (without the &#39;.py&#39; extension), and the path to the module.</span>
<span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;quad&quot;</span><span class="p">,</span> <span class="s2">&quot;quadratic&quot;</span><span class="p">,</span> <span class="s2">&quot;../MCcubed/examples/models/&quot;</span><span class="p">)</span>

<span class="c1"># Alternatively, if the module is already within the scope of the</span>
<span class="c1"># Python path, the user can set func with a two-elements tuple:</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../MCcubed/examples/models/&quot;</span><span class="p">)</span>
<span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;quad&quot;</span><span class="p">,</span> <span class="s2">&quot;quadratic&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Important!</p>
<p class="last">The only requirement for the modeling function is that its arguments follow
the same structure of the callable in <code class="docutils literal"><span class="pre">scipy.optimize.leastsq</span></code>, i.e.,
the first argument contains the list of fitting parameters.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">indparams</span></code> argument (optional) packs any additional argument that the
modeling function may require:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># indparams contains additional arguments of func (if necessary). Each</span>
<span class="c1"># additional argument is an item in the indparams tuple:</span>
<span class="n">indparams</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Even if there is only one additional argument to <code class="docutils literal"><span class="pre">func</span></code>, indparams must
be defined as a tuple (as in the example above).  Eventually, the modeling
function could be called with the following command:</p>
<p class="last"><code class="docutils literal"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">func(params,</span> <span class="pre">*indparams)</span></code></p>
</div>
</div>
<div class="section" id="fitting-parameters">
<h3>Fitting Parameters<a class="headerlink" href="#fitting-parameters" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">params</span></code> argument (required) contains the initial-guess values for the model fitting parameters.  The <code class="docutils literal"><span class="pre">params</span></code> argument must be a 1D float ndarray.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Array of initial-guess values of fitting parameters:</span>
<span class="n">params</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">10.0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span>   <span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">pmin</span></code> and <code class="docutils literal"><span class="pre">pmax</span></code> arguments (optional) set the lower and upper boundaries explored by the MCMC for each fitting parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Lower and upper boundaries for the MCMC exploration:</span>
<span class="n">pmin</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">])</span>
<span class="n">pmax</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">])</span>
</pre></div>
</div>
<p>If a proposed step falls outside the set boundaries,
that iteration is automatically rejected.
The default values for each element of <code class="docutils literal"><span class="pre">pmin</span></code> and <code class="docutils literal"><span class="pre">pmax</span></code> are
<code class="docutils literal"><span class="pre">-np.inf</span></code> and <code class="docutils literal"><span class="pre">+np.inf</span></code>, respectively.
The <code class="docutils literal"><span class="pre">pmin</span></code> and <code class="docutils literal"><span class="pre">pmax</span></code> arrays must have the same size of <code class="docutils literal"><span class="pre">params</span></code>.</p>
</div>
<div class="section" id="stepsize-fixed-and-shared-paramerers">
<h3>Stepsize, Fixed, and Shared Paramerers<a class="headerlink" href="#stepsize-fixed-and-shared-paramerers" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">stepsize</span></code> argument (required) is a 1D float ndarray,
where each element correspond to one of the fitting parameters.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stepsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>  <span class="mf">1.0</span><span class="p">,</span>   <span class="mf">0.5</span><span class="p">,</span>   <span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
<p>The stepsize has a dual purpose: (1) detemines the free, fixed, and
shared parameters; and (2) determines the step size of proposal jumps.</p>
<p>To fix a parameter at the given initial-guess value,
set the stepsize of the given parameter to <span class="math">\(0\)</span>.
To share the same value for multiple parameters along the MCMC exploration,
set the stepsize of the parameter equal to the negative
index of the sharing parameter, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># If I want the second, third, and fourth model parameters to share the same value:</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Clearly, in the current example it doesn&#8217;t make sense to share parameter
values.  However, for an eclipe model for example, one may want to share
the ingress and egress times.</p>
</div>
<p>Additionally, when <code class="docutils literal"><span class="pre">walk='mrw'</span></code> (see <a class="reference internal" href="#walk"><span>Random Walk</span></a> section), <code class="docutils literal"><span class="pre">stepsize</span></code>
sets the standard deviation, <span class="math">\(\sigma\)</span>, of the Gaussian proposal jump for
the given parameter (see Eq. <a href="#equation-gaussprop">(4)</a>).</p>
<p>Lastly, <code class="docutils literal"><span class="pre">stepsize</span></code> sets the standard deviation of the initial sampling
for the chains (see <a class="reference internal" href="#mcchains"><span>MCMC Config</span></a> section).</p>
</div>
<div class="section" id="parameter-priors">
<h3>Parameter Priors<a class="headerlink" href="#parameter-priors" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">prior</span></code>, <code class="docutils literal"><span class="pre">priorlow</span></code>, and <code class="docutils literal"><span class="pre">priorup</span></code> arguments (optional) set the
prior probability distributions of the fitting parameters.
Each of these arguments is a 1D float ndarray.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># priorlow defines whether to use uniform non-informative (priorlow = 0.0),</span>
<span class="c1"># Jeffreys non-informative (priorlow &lt; 0.0), or Gaussian prior (priorlow &gt; 0.0).</span>
<span class="c1"># prior and priorup are irrelevant if priorlow &lt;= 0 (for a given parameter)</span>
<span class="n">prior</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="mf">0.0</span><span class="p">])</span>
<span class="n">priorlow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="mf">0.0</span><span class="p">])</span>
<span class="n">priorup</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="mf">0.0</span><span class="p">])</span>
</pre></div>
</div>
<p>MC3 supports three types of priors.
If a value of <code class="docutils literal"><span class="pre">priorlow</span></code> is <span class="math">\(0.0\)</span> (default) for a given parameter,
the MCMC will apply a uniform non-informative prior:</p>
<div class="math" id="equation-noninfprior">
<span class="eqno">(1)</span>\[p(\theta) = \frac{1}{\theta_{\rm max} - \theta_{\rm min}},\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is appropriate when there is no prior knowledge of the
value of <span class="math">\(\theta\)</span>.</p>
</div>
<p>If <code class="docutils literal"><span class="pre">priorlow</span></code> is less than <span class="math">\(0.0\)</span> for a given parameter,
the MCMC will apply a Jeffreys non-informative prior
(uniform probability per order of magnitude):</p>
<div class="math" id="equation-jeffreysprior">
<span class="eqno">(2)</span>\[p(\theta) = \frac{1}{\theta \ln(\theta_{\rm max}/\theta_{\rm min})},\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is valid only when the parameter takes positive values.
This is a more appropriate prior than a uniform prior when <span class="math">\(\theta\)</span>
can take values over several orders of magnitude.
For more information, see <a class="reference internal" href="#gregory2005" id="id1">[Gregory2005]</a>, Sec. 3.7.1.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Practical note!</p>
<p class="last">In practice, I have seen better results when one fits
<span class="math">\(\log(\theta)\)</span> rather than <span class="math">\(\theta\)</span> with a Jeffreys prior.</p>
</div>
<p>Lastly, if <code class="docutils literal"><span class="pre">priorlow</span></code> is greater than  <span class="math">\(0.0\)</span> for a given parameter,
the MCMC will apply a Gaussian informative prior:</p>
<div class="math" id="equation-gaussianprior">
<span class="eqno">(3)</span>\[p(\theta) = \frac{1}{\sqrt{2\pi\sigma_{p}^{2}}}
       \exp\left(\frac{-(\theta-\theta_{p})^{2}}{2\sigma_{p}^{2}}\right),\]</div>
<p>where <code class="docutils literal"><span class="pre">prior</span></code> sets the prior value <span class="math">\(\theta_{p}\)</span>, and
<code class="docutils literal"><span class="pre">priorlow</span></code> and <code class="docutils literal"><span class="pre">priorup</span></code>
set the lower and upper <span class="math">\(1\sigma\)</span> prior uncertainties,
<span class="math">\(\sigma_{p}\)</span>, of the prior (depending if the proposed value
<span class="math">\(\theta\)</span> is lower or higher than <span class="math">\(\theta_{p}\)</span>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that, even when the parameter boundaries are not known or when
the parameter is unbound, this prior is suitable for use in the MCMC
sampling, since the proposed and current state priors divide out in
the Metropolis ratio.</p>
</div>
</div>
<div class="section" id="random-walk">
<span id="walk"></span><h3>Random Walk<a class="headerlink" href="#random-walk" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">walk</span></code> argument (optional) defines which random-walk algorithm
for the MCMC:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Choose between: &#39;snooker&#39;, &#39;demc&#39;, or &#39;mrw&#39;:</span>
<span class="n">walk</span> <span class="o">=</span> <span class="s1">&#39;snooker&#39;</span>
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">walk</span> <span class="pre">=</span> <span class="pre">'snooker'</span></code> (default, recommended), <code class="docutils literal"><span class="pre">MC3</span></code> will use the
DEMC-z algorithm with snooker propsals (see <a class="reference internal" href="#braakvrugt2008" id="id2">[BraakVrugt2008]</a>).
If <code class="docutils literal"><span class="pre">walk</span> <span class="pre">=</span> <span class="pre">'demc'</span></code>, <code class="docutils literal"><span class="pre">MC3</span></code> will use Differential-Evolution
MCMC algorithm (see <a class="reference internal" href="#terbraak2006" id="id3">[terBraak2006]</a>).</p>
<p>If <code class="docutils literal"><span class="pre">walk</span> <span class="pre">=</span> <span class="pre">'mrw'</span></code>, <code class="docutils literal"><span class="pre">MC3</span></code> will use the classical Metropolis-Hastings
algorithm with Gaussian proposal distributions.  I.e., in each
iteration and for each parameter, <span class="math">\(\theta\)</span>, the MCMC will propose
jumps, drawn from
Gaussian distributions centered at the current value, <span class="math">\(\theta_0\)</span>, with
a standard deviation, <span class="math">\(\sigma\)</span>, given by the values in the <code class="docutils literal"><span class="pre">stepsize</span></code>
argument:</p>
<div class="math" id="equation-gaussprop">
<span class="eqno">(4)</span>\[q(\theta) = \frac{1}{\sqrt{2 \pi \sigma^2}}
            \exp \left( -\frac{(\theta-\theta_0)^2}{2 \sigma^2}\right)\]</div>
</div>
<div class="section" id="mcmc-config">
<span id="mcchains"></span><h3>MCMC Config<a class="headerlink" href="#mcmc-config" title="Permalink to this headline">¶</a></h3>
<p>The following arguments set the MCMC chains configuration:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">nsamples</span> <span class="o">=</span>  <span class="mf">1e5</span>     <span class="c1"># Number of MCMC samples to compute</span>
<span class="n">nchains</span>  <span class="o">=</span>    <span class="mi">7</span>     <span class="c1"># Number of parallel chains</span>
<span class="n">burnin</span>   <span class="o">=</span> <span class="mi">1000</span>     <span class="c1"># Number of burned-in samples per chain</span>
<span class="n">thinning</span> <span class="o">=</span>    <span class="mi">1</span>     <span class="c1"># Thinning factor for outputs</span>

<span class="c1"># Distribution for the initial samples:</span>
<span class="n">kickoff</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>  <span class="c1"># Choose between: &#39;normal&#39; or  &#39;uniform&#39;</span>
<span class="n">hsize</span> <span class="o">=</span> <span class="mi">10</span>          <span class="c1"># Number of initial samples per chain</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">MC3</span></code> automatically runs in multiple processors, assigning one CPU per chain.
Additionaly, the central MCMC hub will use one extra CPU.  Thus, the total
number of CPUs used is <code class="docutils literal"><span class="pre">nchains</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">nsamples</span></code> argument (optional, float, default=1e5) sets the total
number of samples to compute.</p>
<p>The <code class="docutils literal"><span class="pre">nchains</span></code> argument (optional, integer, default=7) sets the number
of parallel chains to use.  The number of iterations run for each chain
will be <code class="docutils literal"><span class="pre">ceil(nsamples/nchains)</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For <code class="docutils literal"><span class="pre">walk='snooker'</span></code>, an MCMC works well from
3 chains.  For <code class="docutils literal"><span class="pre">walk='demc'</span></code>, <a class="reference internal" href="#terbraak2006" id="id4">[terBraak2006]</a> suggest using
<span class="math">\(2d\)</span> chains, with <span class="math">\(d\)</span> the number of free parameters.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">burnin</span></code> argument (optional, integer, default=0) sets the number
of burned-in (removed) iterations at the beginning of each chain.</p>
<p>The <code class="docutils literal"><span class="pre">thinning</span></code> argument (optional, integer, default=1) sets the chains
thinning factor (discarding all but every <code class="docutils literal"><span class="pre">thinning</span></code>-th sample).
To reduce the memory usage, when requested, only the thinned samples
are stored (and returned).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Thinning is often unnecessary for a DE run, since this algorithm
reduces significatively the sampling autocorrelation.</p>
</div>
<p>To set the starting point of the MCMC chains, <code class="docutils literal"><span class="pre">MC3</span></code> draws samples either
from a normal (default) or uniform distribution (determined by
the <code class="docutils literal"><span class="pre">kickoff</span></code> argument).  The mean and standard deviation of the normal
distribution are set by the <code class="docutils literal"><span class="pre">params</span></code> and <code class="docutils literal"><span class="pre">stepsize</span></code> arguments,
respectively.
The uniform distribution is constrained between the <code class="docutils literal"><span class="pre">pmin</span></code> and <code class="docutils literal"><span class="pre">pmax</span></code>
boundaries.
The <code class="docutils literal"><span class="pre">hsize</span></code> argument determines the size of the starting sample.
All draws from the initial sample are discarded from the returned
posterior distribution.</p>
</div>
<div class="section" id="optimization">
<h3>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">leastsq</span></code> argument (optional, boolean, default=False) is a flag that
indicates <code class="docutils literal"><span class="pre">MC3</span></code> to run a least-squares optimization before running the MCMC.
<code class="docutils literal"><span class="pre">MC3</span></code> implements the Levenberg-Marquardt algorithm (<code class="docutils literal"><span class="pre">lm=True</span></code>) via
<code class="docutils literal"><span class="pre">scipy.optimize.leastsq</span></code> or Trust Region Reflective (<code class="docutils literal"><span class="pre">lm=False</span></code>) via
<code class="docutils literal"><span class="pre">scipy.optimize.least_squares</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The parameter boundaries (for TRF only, see <a class="reference internal" href="fittutorial.html#fittutorial"><span>Optimization Tutorial</span></a>),
fixed and shared-values, and priors will apply for the minimization.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">chisqscale</span></code> argument (optional, boolean, default=False) is a flag that
indicates <code class="docutils literal"><span class="pre">MC3</span></code> to scale the data uncertainties to force a reduced
<span class="math">\(\chi^{2}\)</span> equal to <span class="math">\(1.0\)</span>.  The scaling applies by multiplying all
uncertainties by a common scale factor.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">leastsq</span>    <span class="o">=</span> <span class="bp">True</span>   <span class="c1"># Least-squares minimization prior to the MCMC</span>
<span class="n">lm</span>         <span class="o">=</span> <span class="bp">True</span>   <span class="c1"># Choose Levenberg-Marquardt (True) or TRF algorithm (False)</span>
<span class="n">chisqscale</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># Scale the data uncertainties such that red. chisq = 1</span>
</pre></div>
</div>
</div>
<div class="section" id="convergence-test">
<h3>Convergence Test<a class="headerlink" href="#convergence-test" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">grtest</span></code> argument (optional, boolean, default=False) is a flag that
indicates MC3 to run the Gelman-Rubin convergence test for the MCMC sample of
fitting parameters.
Values larger than 1.01 are indicative of non-convergence.
See <a class="reference internal" href="#gelmanrubin1992" id="id5">[GelmanRubin1992]</a> for further information.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">grtest</span>  <span class="o">=</span> <span class="bp">True</span>   <span class="c1"># Calculate the GR convergence test</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Gelman-Rubin test is computed every 10% of the MCMC exploration.</p>
</div>
</div>
<div class="section" id="wavelet-likelihood-mcmc">
<h3>Wavelet-Likelihood MCMC<a class="headerlink" href="#wavelet-likelihood-mcmc" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">wlike</span></code> argument (optional, boolean, default=False) allows MC3 to
implement the Wavelet-based method to estimate time-correlated noise.
When using this method, the used must append the three additional fitting
parameters (<span class="math">\(\gamma, \sigma_{r}, \sigma_{w}\)</span>) from Carter &amp; Winn (2009)
to the end of the <code class="docutils literal"><span class="pre">params</span></code> array.  Likewise, add the correspoding values
to the <code class="docutils literal"><span class="pre">pmin</span></code>, <code class="docutils literal"><span class="pre">pmax</span></code>, <code class="docutils literal"><span class="pre">stepsize</span></code>, <code class="docutils literal"><span class="pre">prior</span></code>, <code class="docutils literal"><span class="pre">priorlow</span></code>,
and <code class="docutils literal"><span class="pre">priorup</span></code> arrays.
For further information see <a class="reference internal" href="#carterwinn2009" id="id6">[CarterWinn2009]</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">wlike</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># Use Carter &amp; Winn&#39;s Wavelet-likelihood method.</span>
</pre></div>
</div>
</div>
<div class="section" id="file-outputs">
<h3>File Outputs<a class="headerlink" href="#file-outputs" title="Permalink to this headline">¶</a></h3>
<p>The following arguments set the output files produced by MC3:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">log</span>       <span class="o">=</span> <span class="s1">&#39;MCMC.log&#39;</span>         <span class="c1"># Save the MCMC screen outputs to file</span>
<span class="n">savefile</span>  <span class="o">=</span> <span class="s1">&#39;MCMC_sample.npz&#39;</span>  <span class="c1"># Save the MCMC parameters sample to file</span>
<span class="n">plots</span>     <span class="o">=</span> <span class="bp">True</span>               <span class="c1"># Generate best-fit, trace, and posterior plots</span>
<span class="n">rms</span>       <span class="o">=</span> <span class="bp">False</span>              <span class="c1"># Compute and plot the time-averaging test</span>
<span class="n">full_output</span> <span class="o">=</span> <span class="bp">False</span>            <span class="c1"># Return the full posterior sample</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">log</span></code> argument (optional, string, default=None)
sets the file name where to store <code class="docutils literal"><span class="pre">MC3</span></code>&#8216;s screen output.</p>
<p>The <code class="docutils literal"><span class="pre">savefile</span></code> arguments (optional, string, default=None)
set the file names where to store the MCMC outputs into a <code class="docutils literal"><span class="pre">.npz</span></code> file, with
keywords <code class="docutils literal"><span class="pre">bestp</span></code>, <code class="docutils literal"><span class="pre">Z</span></code>, and <code class="docutils literal"><span class="pre">Zchain</span></code>.
The files can be read with the <code class="docutils literal"><span class="pre">numpy.load()</span></code> function.
<code class="docutils literal"><span class="pre">bestp</span></code> is a 1D array with the best-fitting parameters (including fixed
and shared parameters), <code class="docutils literal"><span class="pre">Z</span></code> is a 2D array (Nsamples, Nfree) containing the
thinned MCMC parameter posterior of the free parameters (excluding
fixed and shared).  This array includes the initial and burnin samples.
<code class="docutils literal"><span class="pre">Zchain</span></code> is a 1D array containing the chain index for each sample in <code class="docutils literal"><span class="pre">Z</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">plots</span></code> argument (optional, boolean, default=False) is a flag that
indicates MC3 to generate and store the data (along with the best-fitting
model) plot,
the MCMC-chain trace plot for each parameter,
and the marginalized and pair-wise posterior plots.</p>
<p>The <code class="docutils literal"><span class="pre">rms</span></code> argument (optional, boolean, default=False) is a flag that
indicates <code class="docutils literal"><span class="pre">MC3</span></code> to compute the time-averaging test for time-correlated noise
and generate a rms-vs-binsize plot (see <a class="reference internal" href="#winn2008" id="id7">[Winn2008]</a>).</p>
<p>The <code class="docutils literal"><span class="pre">full_output</span></code> argument (optional, bool, default=False) flags the code
to return the full posterior sampling array (<code class="docutils literal"><span class="pre">Z</span></code>), including the initial
and burnin samples.  The posterior will still be thinned though.</p>
</div>
<div class="section" id="returned-values">
<h3>Returned Values<a class="headerlink" href="#returned-values" title="Permalink to this headline">¶</a></h3>
<p>When run from a pyhton interactive session, <code class="docutils literal"><span class="pre">MC3</span></code> will return six arrays:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bestp</span></code>: a 1D array with the best-fitting parameters (including
fixed and shared parameters).</li>
<li><code class="docutils literal"><span class="pre">CRlo</span></code>: a 1D array with the lower boundary of the marginal 68%-highest
posterior density (the credible region) for each parameter,
with respect to <code class="docutils literal"><span class="pre">bestp</span></code>.</li>
<li><code class="docutils literal"><span class="pre">CRhi</span></code>:a 1D array with the upper boundary of the marginal
68%-highest posterior density for each parameter, with respect to
<code class="docutils literal"><span class="pre">bestp</span></code>.</li>
<li><code class="docutils literal"><span class="pre">stdp</span></code>: a 1D array with the standard deviation of the marginal
posterior for each parameter (including that of fixed and shared
parameters).</li>
<li><code class="docutils literal"><span class="pre">posterior</span></code>: a 2D array containing the burned-in, thinned MCMC
sample of the parameters posterior distribution (with dimensions
[nsamples, nfree], excluding fixed and shared parameters).</li>
<li><code class="docutils literal"><span class="pre">Zchain</span></code>: a 1D array with the indices of the chains for each
sample in <code class="docutils literal"><span class="pre">posterior</span></code>.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Run the MCMC:</span>
<span class="n">bestp</span><span class="p">,</span> <span class="n">CRlo</span><span class="p">,</span> <span class="n">CRhi</span><span class="p">,</span> <span class="n">stdp</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">Zchain</span> <span class="o">=</span> <span class="n">mc3</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">uncert</span><span class="o">=</span><span class="n">uncert</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">indparams</span><span class="o">=</span><span class="n">indparams</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">pmin</span><span class="o">=</span><span class="n">pmin</span><span class="p">,</span> <span class="n">pmax</span><span class="o">=</span><span class="n">pmax</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="n">stepsize</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">priorlow</span><span class="o">=</span><span class="n">priorlow</span><span class="p">,</span> <span class="n">priorup</span><span class="o">=</span><span class="n">priorup</span><span class="p">,</span>
    <span class="n">walk</span><span class="o">=</span><span class="n">walk</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">,</span>  <span class="n">nchains</span><span class="o">=</span><span class="n">nchains</span><span class="p">,</span>
    <span class="n">burnin</span><span class="o">=</span><span class="n">burnin</span><span class="p">,</span> <span class="n">thinning</span><span class="o">=</span><span class="n">thinning</span><span class="p">,</span>
    <span class="n">leastsq</span><span class="o">=</span><span class="n">leastsq</span><span class="p">,</span> <span class="n">lm</span><span class="o">=</span><span class="n">lm</span><span class="p">,</span> <span class="n">chisqscale</span><span class="o">=</span><span class="n">chisqscale</span><span class="p">,</span>
    <span class="n">hsize</span><span class="o">=</span><span class="n">hsize</span><span class="p">,</span> <span class="n">kickoff</span><span class="o">=</span><span class="n">kickoff</span><span class="p">,</span>
    <span class="n">grtest</span><span class="o">=</span><span class="n">grtest</span><span class="p">,</span> <span class="n">wlike</span><span class="o">=</span><span class="n">wlike</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="n">savefile</span><span class="p">,</span> <span class="n">rms</span><span class="o">=</span><span class="n">rms</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that <code class="docutils literal"><span class="pre">bestp</span></code>, <code class="docutils literal"><span class="pre">CRlo</span></code>, <code class="docutils literal"><span class="pre">CRhi</span></code>, and <code class="docutils literal"><span class="pre">stdp</span></code>
include the values for all model parameters, including fixed and
shared parameters, whereas <code class="docutils literal"><span class="pre">posterior</span></code> includes only
the free parameters.  Be careful with the dimesions.</p>
</div>
<blockquote>
<div>TBD</div></blockquote>
</div>
</div>
<div class="section" id="inputs-from-files">
<h2>Inputs from Files<a class="headerlink" href="#inputs-from-files" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">data</span></code>, <code class="docutils literal"><span class="pre">uncert</span></code>, <code class="docutils literal"><span class="pre">indparams</span></code>, <code class="docutils literal"><span class="pre">params</span></code>, <code class="docutils literal"><span class="pre">pmin</span></code>, <code class="docutils literal"><span class="pre">pmax</span></code>,
<code class="docutils literal"><span class="pre">stepsize</span></code>, <code class="docutils literal"><span class="pre">prior</span></code>, <code class="docutils literal"><span class="pre">priorlow</span></code>, and <code class="docutils literal"><span class="pre">priorup</span></code> input arrays
can be optionally be given as input file.
Furthermore, multiple input arguments can be combined into a single file.</p>
<div class="section" id="datafile">
<span id="id8"></span><h3>Data<a class="headerlink" href="#datafile" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">data</span></code>, <code class="docutils literal"><span class="pre">uncert</span></code>, and <code class="docutils literal"><span class="pre">indparams</span></code> inputs can be provided as
binary <code class="docutils literal"><span class="pre">numpy</span></code> <code class="docutils literal"><span class="pre">.npz</span></code> files.
<code class="docutils literal"><span class="pre">data</span></code> and <code class="docutils literal"><span class="pre">uncert</span></code> can be stored together into a single file.
An <code class="docutils literal"><span class="pre">indparams</span></code> input file contain the list of independent variables
(must be a list, even if there is a single independent variable).</p>
<p>The <code class="docutils literal"><span class="pre">utils</span></code> sub-package of <code class="docutils literal"><span class="pre">MC3</span></code> provide utility functions to
save and load these files.
The <code class="docutils literal"><span class="pre">preamble.py</span></code> file in
<a class="reference external" href="https://github.com/pcubillos/MCcubed/blob/master/examples/demo02/">demo02</a>
gives an example of how to create <code class="docutils literal"><span class="pre">data</span></code> and <code class="docutils literal"><span class="pre">indparams</span></code> input files:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Import the necessary modules:</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1"># Import the modules from the MCcubed package:</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../MCcubed/&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">MCcubed</span> <span class="kn">as</span> <span class="nn">mc3</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../MCcubed/examples/models/&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">quadratic</span> <span class="kn">import</span> <span class="n">quad</span>


<span class="c1"># Create a synthetic dataset using a quadratic polynomial curve:</span>
<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>       <span class="c1"># Independent model variable</span>
<span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>                   <span class="c1"># True-underlying model parameters</span>
<span class="n">y</span>  <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>                      <span class="c1"># Noiseless model</span>
<span class="n">uncert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>           <span class="c1"># Data points uncertainty</span>
<span class="n">error</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">uncert</span><span class="p">)</span>  <span class="c1"># Noise for the data</span>
<span class="n">data</span>   <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">error</span>                    <span class="c1"># Noisy data set</span>

<span class="c1"># data.npz contains the data and uncertainty arrays:</span>
<span class="n">mc3</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">savebin</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">uncert</span><span class="p">],</span> <span class="s1">&#39;data.npz&#39;</span><span class="p">)</span>
<span class="c1"># indp.npz contains a list of variables:</span>
<span class="n">mc3</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">savebin</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="s1">&#39;indp.npz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>Fitting Parameters<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">params</span></code>, <code class="docutils literal"><span class="pre">pmin</span></code>, <code class="docutils literal"><span class="pre">pmax</span></code>, <code class="docutils literal"><span class="pre">stepsize</span></code>,
<code class="docutils literal"><span class="pre">prior</span></code>, <code class="docutils literal"><span class="pre">priorlow</span></code>, and <code class="docutils literal"><span class="pre">priorup</span></code> inputs
can be provided as plain ASCII files.
For simplycity all of these input arguments can be combined into
a single file.</p>
<p>In the <code class="docutils literal"><span class="pre">params</span></code> file, each line correspond to one model
parameter, whereas each column correspond to one of the input array arguments.
This input file can hold as few or as many of these argument arrays,
as long as they are provided in that exact order.
Empty or comment lines are allowed (and ignored by the reader).
A valid params file look like this:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>#       params            pmin            pmax        stepsize
            10             -10              40             1.0
          -2.0             -20              20             0.5
           0.1             -10              10             0.1
</pre></div>
</div>
<p>Alternatively, the <code class="docutils literal"><span class="pre">utils</span></code> sub-package of <code class="docutils literal"><span class="pre">MC3</span></code> provide utility
functions to save and load these files:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">params</span>   <span class="o">=</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">]</span>
<span class="n">pmin</span>     <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="n">pmax</span>     <span class="o">=</span> <span class="p">[</span> <span class="mi">40</span><span class="p">,</span>   <span class="mi">20</span><span class="p">,</span>  <span class="mi">10</span><span class="p">]</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">]</span>

<span class="c1"># Store ASCII arrays:</span>
<span class="n">mc3</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">saveascii</span><span class="p">([</span><span class="n">params</span><span class="p">,</span> <span class="n">pmin</span><span class="p">,</span> <span class="n">pmax</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">],</span> <span class="s1">&#39;params.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, to run the MCMC simply provide the input file names to the <code class="docutils literal"><span class="pre">MC3</span></code>
routine:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># To run MCMC, set the arguments to the file names:</span>
<span class="n">data</span>      <span class="o">=</span> <span class="s1">&#39;data.npz&#39;</span>
<span class="n">indparams</span> <span class="o">=</span> <span class="s1">&#39;indp.npz&#39;</span>
<span class="n">params</span>    <span class="o">=</span> <span class="s1">&#39;params.txt&#39;</span>
<span class="c1"># Run MCMC:</span>
<span class="n">bestp</span><span class="p">,</span> <span class="n">CRlo</span><span class="p">,</span> <span class="n">CRhi</span><span class="p">,</span> <span class="n">stdp</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">Zchain</span> <span class="o">=</span> <span class="n">mc3</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">indparams</span><span class="o">=</span><span class="n">indparams</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
    <span class="n">walk</span><span class="o">=</span><span class="n">walk</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">,</span>  <span class="n">nchains</span><span class="o">=</span><span class="n">nchains</span><span class="p">,</span>
    <span class="n">burnin</span><span class="o">=</span><span class="n">burnin</span><span class="p">,</span> <span class="n">thinning</span><span class="o">=</span><span class="n">thinning</span><span class="p">,</span>
    <span class="n">leastsq</span><span class="o">=</span><span class="n">leastsq</span><span class="p">,</span> <span class="n">lm</span><span class="o">=</span><span class="n">lm</span><span class="p">,</span> <span class="n">chisqscale</span><span class="o">=</span><span class="n">chisqscale</span><span class="p">,</span>
    <span class="n">hsize</span><span class="o">=</span><span class="n">hsize</span><span class="p">,</span> <span class="n">kickoff</span><span class="o">=</span><span class="n">kickoff</span><span class="p">,</span>
    <span class="n">grtest</span><span class="o">=</span><span class="n">grtest</span><span class="p">,</span> <span class="n">wlike</span><span class="o">=</span><span class="n">wlike</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="n">savefile</span><span class="p">,</span> <span class="n">rms</span><span class="o">=</span><span class="n">rms</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="carterwinn2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[CarterWinn2009]</a></td><td><a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...704...51C">Carter &amp; Winn (2009): Parameter Estimation from Time-series Data with Correlated Errors: A Wavelet-based Method and its Application to Transit Light Curves</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gelmanrubin1992" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[GelmanRubin1992]</a></td><td><a class="reference external" href="http://projecteuclid.org/euclid.ss/1177011136">Gelman &amp; Rubin (1992): Inference from Iterative Simulation Using Multiple Sequences</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gregory2005" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Gregory2005]</a></td><td><a class="reference external" href="http://adsabs.harvard.edu/abs/2005blda.book.....G">Gregory (2005): Bayesian Logical Data Analysis for the Physical Sciences</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="terbraak2006" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[terBraak2006]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> <a class="reference external" href="http://dx.doi.org/10.1007/s11222-006-8769-1">ter Braak (2006): A Markov Chain Monte Carlo version of the genetic algorithm Differential Evolution</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="braakvrugt2008" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[BraakVrugt2008]</a></td><td><a class="reference external" href="http://dx.doi.org/10.1007/s11222-008-9104-9">ter Braak &amp; Vrugt (2008): Differential Evolution Markov Chain with snooker updater and fewer chains</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="winn2008" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[Winn2008]</a></td><td><a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...683.1076W">Winn et al. (2008): The Transit Light Curve Project. IX. Evidence for a Smaller Radius of the Exoplanet XO-3b</a></td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">MCMC Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#argument-inputs">Argument Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-files">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mcmc-run">MCMC Run</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data">Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modeling-function">Modeling Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fitting-parameters">Fitting Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stepsize-fixed-and-shared-paramerers">Stepsize, Fixed, and Shared Paramerers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-priors">Parameter Priors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#random-walk">Random Walk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc-config">MCMC Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization">Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convergence-test">Convergence Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wavelet-likelihood-mcmc">Wavelet-Likelihood MCMC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-outputs">File Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#returned-values">Returned Values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inputs-from-files">Inputs from Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datafile">Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Fitting Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fittutorial.html">Optimization Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="getstarted.html"
                        title="previous chapter">Getting Started</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fittutorial.html"
                        title="next chapter">Optimization Tutorial</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="fittutorial.html" title="Optimization Tutorial"
             >next</a> |</li>
        <li class="right" >
          <a href="getstarted.html" title="Getting Started"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MC3 2.2.14 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015-2016, Patricio Cubillos.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>